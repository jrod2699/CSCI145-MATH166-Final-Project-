#!/usr/bin/env python3

# command line args
import argparse
parser = argparse.ArgumentParser()
parser.add_argument('--date',required=True)
args = parser.parse_args()

# imports
import os
import zipfile
import datetime 
import json
import pandas as pd
import textblob as TextBlob

data = pd.DataFrame(columns='text', 'date', 'city', 'state'])

df = pd.read_csv(args.date + '.csv', error_bad_lines=False, encoding='utf-8 ', engine='python')

data = pd.concat([data, df], axis=0]
data = data.reset_index(drop=True)


data['polarity'] = data['text'].apply(lambda tweet: TextBlob(tweet).sentiment.polarity)

df.to_csv('sample.csv', index=False)

